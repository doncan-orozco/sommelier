<% content_for :title, "Your Order - La Reta" %>

<header class="bg-gradient-to-r from-green-800 to-green-600 text-white">
  <div class="container mx-auto px-4 py-8 text-center">
    <h1 class="text-4xl font-bold mb-2">🍽️ Your Order</h1>
    <p class="text-xl opacity-90">Review and confirm your order</p>
  </div>
</header>

<div class="container mx-auto px-4 py-8" data-controller="order-form">
  <div class="max-w-4xl mx-auto">
    <!-- Order Items -->
    <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
      <h2 class="text-2xl font-bold text-green-800 mb-6 text-center">Order Summary</h2>
      
      <div id="order-items" data-order-form-target="orderItems">
        <!-- Items will be loaded by JavaScript -->
      </div>
      
      <div class="border-t pt-4 mt-6" data-order-form-target="orderTotal">
        <!-- Total will be calculated by JavaScript -->
      </div>
    </div>
    
    <!-- Order Form -->
    <div class="bg-white rounded-lg shadow-lg p-6" data-order-form-target="orderForm" style="display: none;">
      <h3 class="text-xl font-bold text-green-800 mb-6">Order Information</h3>
      
      <%= form_with model: @order, url: orders_path, local: false, 
          class: "space-y-4", 
          data: { action: "submit->order-form#submitOrder" } do |form| %>
        
        <div>
          <%= form.label :table_name, "Customer Name", class: "block text-sm font-medium text-gray-700 mb-1" %>
          <%= form.text_field :table_name, 
              class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",
              placeholder: "Enter your name",
              required: true %>
        </div>
        
        <div>
          <%= form.label :notes, "Special Notes (Optional)", class: "block text-sm font-medium text-gray-700 mb-1" %>
          <%= form.text_area :notes, 
              rows: 3,
              class: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500",
              placeholder: "Allergies, cooking preferences, etc..." %>
        </div>
        
        <!-- Hidden field for cart items -->
        <input type="hidden" name="items" data-order-form-target="itemsInput">
        
        <div class="flex flex-col sm:flex-row gap-4 pt-6">
          <%= form.submit "🚀 Confirm Order", 
              class: "bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg transition-colors",
              data: { order_form_target: "submitButton" } %>
          
          <button type="button" 
                  class="bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-6 rounded-lg transition-colors"
                  data-action="click->order-form#clearOrder">
            🗑️ Clear Order
          </button>
          
          <%= link_to "← Back to Menu", root_path, 
              class: "bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-lg transition-colors text-center" %>
        </div>
      <% end %>
    </div>
    
    <!-- Empty Order State -->
    <div class="bg-white rounded-lg shadow-lg p-6 text-center" data-order-form-target="emptyState">
      <div class="text-6xl mb-4">🛒</div>
      <h3 class="text-2xl font-bold text-gray-600 mb-2">Your cart is empty</h3>
      <p class="text-gray-500 mb-6">Add some delicious items from our menu</p>
      <%= link_to "View Menu", root_path, 
          class: "bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-lg transition-colors" %>
    </div>
  </div>
</div>

<!-- Success Modal -->
<div id="success-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50" data-order-form-target="successModal">
  <div class="bg-white rounded-lg p-8 max-w-md mx-4">
    <div class="text-center">
      <div class="text-6xl mb-4">✅</div>
      <h3 class="text-2xl font-bold text-green-800 mb-2">Order Confirmed!</h3>
      <p class="text-gray-600 mb-6" data-order-form-target="successMessage">
        Your order has been sent to the kitchen.
      </p>
      <button class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-6 rounded"
              data-action="click->order-form#closeSuccessModal">
        Great!
      </button>
    </div>
  </div>
</div>
